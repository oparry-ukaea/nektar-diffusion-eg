# Nektar ++ Diffusion Example

## Background
This repo contains source files and scripts to run a Nektar++ solver for a 1D diffusion problem of the form

$$
   \frac{\partial T}{\partial t} = -\epsilon\nabla^2T
$$
with various forms of boundary conditions. In particular, arbitrary BC values can read from files (one per timestep) at runtime.
## Prerequisites
- A local build of Nektar (see [here](https://doc.nektar.info/userguide/latest/user-guidese3.html) for detailed instructions) with the following options enabled:
  - NEKTAR_BUILD_LIBRARY
  - NEKTAR_BUILD_UTILITIES
  - NEKTAR_USE_MPI
  - NEKTAR_UTILITY_FIELDCONVERT
  - NEKTAR_UTILITY_NEKMESH
- CMake (tested with version 3.16.3)
- Python 3 (tested with version 3.8.10)
## Building
To build the solver, run
```
  ./make.sh nekbuild=<PATH_TO_NEKTAR_BUILD_DIR>"
```
where `<PATH_TO_NEKTAR_BUILD_DIR>` is usually `<PATH_TO_NEKTAR_ROOT>/build`
## Running
New runs can be executed based on template directories in `runs/templates`.
For templates beginning `'file-based...'`, boundary condition files need to be generated by running:
```
  python scripts/write_BC_files.py 
```

Finally, the Nektar++ solver should be executed with
```
  ./run.sh <template=TEMPLATE_NAME>
```
If no template is specified, `file-based_lorenz` will be used. By default, output will be produced in `runs/TEMPLATE_NAME`, although this can be overridden by passing an explicit name for the run subdirectory, that is:
```
  ./run.sh subdir=my_run
```
will output to runs/my_run.